{% extends "base.html" %}
{% block title %}UNITY 3D{% endblock %}
{% block page_content %}
    <div class="page-header">
        {% if current_user.is_authenticated %}
            <h3>Welcome,{{ current_user.username }}!</h3>
        {% else %}
            <h2>Welcome to Unity3D Cloud Factory.</h2>
            <p>
                <a href="{{ url_for('auth.register') }}">
                Click here to register
                </a>
            </p>
        {% endif %}
    </div>
    <table id="table"></table>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="{{ url_for('static', filename='bootstrap-table.js') }}"></script>
	<script>
    function myInterval(){
        $.getJSON("/online-machines", { cmd: 'machine_info'},
        function (data) { 
            $('#table').bootstrapTable('load', data);
         });
    }

    $(window).ready(function () {
        setInterval("myInterval()", 5000);

        $('#table').bootstrapTable({
            url:'/online-machines?cmd=machine_info',
            search:true,
            showRefresh:true,
            pagination:true,
            pageNumber:1,
            pageSize:10,
            pageList: [10, 25, 50, 100],
            columns: [
            {
                field: 'index',
                title: 'index',
                align: 'center',
                halign: 'center',
                valign: 'center',
                formatter: function (value, row, index) {
                    return index+1;
                }
            }, {
                field: 'address',
                title: 'address',
                align: 'center',
                halign: 'center'
            }, {
                field: 'type',
                title: 'type',
                align: 'center',
                halign: 'center'
            }, {
                field: 'state',
                title: 'state',
                align: 'center',
                halign: 'center'
            }, {
                field: 'task_info',
                title: 'task',
                align: 'center',
                halign: 'center'
            }, {
                field: 'temp_nozzle',
                title: 'temp_nozzle',
                align: 'center',
                halign: 'center'
            }, {
                field: 'temp_bed',
                title: 'temp_bed',
                align: 'center',
                halign: 'center'
            }, {
                field: 'x_size',
                title: 'x(mm)',
                align: 'center',
                halign: 'center'
            }, {
                field: 'y_size',
                title: 'y(mm)',
                align: 'center',
                halign: 'center'
            }, {
                field: 'z_size',
                title: 'z(mm)',
                align: 'center',
                halign: 'center'
            }, {
                field: 'material',
                title: 'material',
                align: 'center',
                halign: 'center'
            }, {
                field: 'material_color',
                title: 'material_color',
                align: 'center',
                halign: 'center'
            }, {
                field: 'nozzle_size',
                title: 'nozzle(mm)',
                align: 'center',
                halign: 'center'
            },{
                field: 'worked_time',
                title: 'worked_time(hours)',
                align: 'center',
                halign: 'center'
            }],
            onRefresh: function () {
            }
        });
        })
	</script>
{% endblock %}

